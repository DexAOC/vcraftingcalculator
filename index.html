<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Calculadora V Rising</title>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root {
      --bg: #f4f4f4;
      --text: #2c3e50;
      --sidebar: #2c3e50;
      --button: #34495e;
      --hover: #1abc9c;
      --active: #16a085;
      --detail-bg: #fff;
      --detail-text: #222;
      --border: #ddd;
      --error: #e74c3c;
      --success: #2ecc71;
      --warning: #f39c12;
    }
    [data-theme="dark"] {
      --bg: #121212;
      --text: #eee;
      --sidebar: #222;
      --button: #333;
      --hover: #3498db;
      --active: #2980b9;
      --detail-bg: #222;
      --detail-text: #eee;
      --border: #444;
      --error: #c0392b;
      --success: #27ae60;
      --warning: #d35400;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      display: flex;
      min-height: 100vh;
      background-color: var(--bg);
      color: var(--text);
      transition: background-color 0.3s, color 0.3s;
      line-height: 1.6;
    }

    .sidebar {
      width: 250px;
      background-color: var(--sidebar);
      padding: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      border-right: 1px solid var(--border);
    }
    .sidebar h2 {
      color: white;
      font-size: 20px;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .sidebar h2 i {
      font-size: 24px;
    }
    .menu-button {
      padding: 12px 15px;
      font-size: 16px;
      color: white;
      background-color: var(--button);
      border: none;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 12px;
      transition: all 0.3s ease;
      text-align: left;
    }
    .menu-button:hover {
      background-color: var(--hover);
      transform: translateX(5px);
    }
    .menu-button[aria-pressed="true"] {
      background-color: var(--active);
      font-weight: 500;
    }
    .menu-button i {
      width: 20px;
      text-align: center;
    }

    .main-content {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      max-width: 800px;
      margin: 0 auto;
    }
    .main-content h1 {
      font-size: 32px;
      margin-bottom: 20px;
      color: var(--hover);
    }
    .main-content h2 {
      font-size: 24px;
      margin: 20px 0 15px;
      color: var(--hover);
    }

    .search-container {
      position: relative;
      max-width: 400px;
      margin-bottom: 20px;
    }
    label {
      display: block;
      margin: 15px 0 8px;
      font-weight: 500;
      color: var(--hover);
    }
    select, input[type="number"], input[type="text"] {
      padding: 10px 12px;
      font-size: 16px;
      width: 100%;
      max-width: 400px;
      margin-bottom: 15px;
      border-radius: 8px;
      border: 1px solid var(--border);
      background-color: var(--detail-bg);
      color: var(--detail-text);
      transition: border-color 0.3s;
    }
    input:focus, select:focus {
      outline: none;
      border-color: var(--hover);
      box-shadow: 0 0 0 2px rgba(26, 188, 156, 0.2);
    }
    ul.suggestions {
      max-width: 400px;
      list-style: none;
      margin: 0;
      padding: 0;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--detail-bg);
      position: absolute;
      z-index: 10;
      width: 100%;
      max-height: 300px;
      overflow-y: auto;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    ul.suggestions li {
      padding: 10px 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: background-color 0.2s;
    }
    ul.suggestions li:hover {
      background-color: var(--hover);
      color: white;
    }
    ul.suggestions li img {
      width: 24px;
      height: 24px;
      object-fit: contain;
      border-radius: 4px;
    }
    ul.suggestions li .item-type {
      font-size: 12px;
      opacity: 0.7;
      margin-left: auto;
    }

    button {
      background-color: var(--button);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      cursor: pointer;
      font-size: 16px;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    button:hover {
      background-color: var(--hover);
      transform: translateY(-2px);
    }
    button:active {
      transform: translateY(0);
    }
    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }
    button i {
      font-size: 14px;
    }

    .result-container {
      margin-top: 30px;
      background: var(--detail-bg);
      color: var(--detail-text);
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      border: 1px solid var(--border);
    }
    .result-header {
      display: flex;
      align-items: flex-start;
      gap: 20px;
      margin-bottom: 20px;
      padding-bottom: 20px;
      border-bottom: 1px solid var(--border);
    }
    .item-image {
      width: 100px;
      height: 100px;
      object-fit: contain;
      border-radius: 8px;
      border: 1px solid var(--border);
      background-color: rgba(0,0,0,0.05);
      padding: 5px;
    }
    .item-info {
      flex: 1;
    }
    .item-info h2 {
      margin-top: 0;
      margin-bottom: 8px;
    }
    .item-meta {
      display: flex;
      gap: 15px;
      margin-bottom: 10px;
      font-size: 14px;
    }
    .item-meta span {
      display: flex;
      align-items: center;
      gap: 5px;
    }
    .item-meta i {
      font-size: 14px;
      opacity: 0.7;
    }
    .item-description {
      font-style: italic;
      opacity: 0.9;
      margin-bottom: 10px;
    }
    .materials-list {
      list-style: none;
      padding-left: 0;
    }
    .materials-list li {
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 12px;
      border-radius: 6px;
      background-color: rgba(0,0,0,0.05);
    }
    .materials-list li img {
      width: 24px;
      height: 24px;
      object-fit: contain;
      border-radius: 4px;
    }
    .expand-btn {
      background: none;
      border: none;
      color: var(--hover);
      cursor: pointer;
      padding: 2px 6px;
      margin-left: 10px;
      font-size: 14px;
    }
    .nested-materials {
      margin-left: 30px;
      margin-top: 10px;
      padding-left: 15px;
      border-left: 2px solid var(--hover);
    }

    .theme-toggle {
      margin-top: auto;
      padding: 12px;
      background: var(--button);
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }
    .theme-toggle:hover {
      background-color: var(--hover);
    }

    .loading {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
      min-height: 200px;
    }
    .loading i {
      font-size: 40px;
      animation: spin 1s linear infinite;
      color: var(--hover);
    }
    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .error-message {
      color: var(--error);
      background-color: rgba(231, 76, 60, 0.1);
      padding: 15px;
      border-radius: 8px;
      margin: 20px 0;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .error-message i {
      font-size: 20px;
    }

    .favorite-btn {
      background: none;
      border: none;
      color: var(--warning);
      cursor: pointer;
      font-size: 18px;
      margin-left: 10px;
    }
    .favorite-btn.active {
      color: gold;
    }

    @media (max-width: 768px) {
      body {
        flex-direction: column;
      }
      .sidebar {
        width: 100%;
        flex-direction: row;
        flex-wrap: wrap;
        padding: 15px;
        gap: 8px;
      }
      .sidebar h2 {
        width: 100%;
        margin-bottom: 15px;
      }
      .menu-button, .theme-toggle {
        flex: 1 1 calc(50% - 8px);
        font-size: 14px;
        padding: 10px;
        gap: 8px;
      }
      .menu-button i {
        font-size: 16px;
      }
      .main-content {
        padding: 20px;
      }
      .result-header {
        flex-direction: column;
      }
      .item-image {
        align-self: center;
      }
    }

    /* Tooltip styles */
    [data-tooltip] {
      position: relative;
    }
    [data-tooltip]::after {
      content: attr(data-tooltip);
      position: absolute;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-size: 14px;
      white-space: nowrap;
      opacity: 0;
      visibility: hidden;
      transition: all 0.2s;
      z-index: 100;
    }
    [data-tooltip]:hover::after {
      opacity: 1;
      visibility: visible;
      bottom: calc(100% + 5px);
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <h2><i class="fas fa-calculator"></i> Calculadora V Rising</h2>
    <button class="menu-button" data-content="home" aria-pressed="true">
      <i class="fas fa-home"></i> In√≠cio
    </button>
    <button class="menu-button" data-content="calculator" aria-pressed="false">
      <i class="fas fa-calculator"></i> Calculadora
    </button>
    <button class="menu-button" data-content="favorites" aria-pressed="false">
      <i class="fas fa-star"></i> Favoritos
    </button>
    <button class="menu-button" data-content="items" aria-pressed="false">
      <i class="fas fa-box-open"></i> Itens
    </button>
    <button class="menu-button" data-content="workbenches" aria-pressed="false">
      <i class="fas fa-hammer"></i> Bancadas
    </button>

    <div class="language-selector">
      <label for="languageSelect"><i class="fas fa-language"></i> Idioma</label>
      <select id="languageSelect" class="language-select">
        <option value="pt">üáßüá∑ Portugu√™s</option>
        <option value="en">üá∫üá∏ English</option>
        <option value="es">üá™üá∏ Espa√±ol</option>
      </select>
    </div>

    <button class="theme-toggle" id="toggleTheme">
      <i class="fas fa-moon"></i> <span>Tema Escuro</span>
    </button>
  </div>

  <div class="main-content" id="main">
    <div class="loading">
      <i class="fas fa-spinner"></i>
      <p>Carregando dados...</p>
    </div>
  </div>

  <script>
    // Aplica√ß√£o principal
    const VrisingCalculator = {
      // Dados da aplica√ß√£o
      data: {
        items: [],
        workbenches: [],
        favorites: JSON.parse(localStorage.getItem('vrisingFavorites')) || [],
        language: localStorage.getItem('vrisingLanguage') || 'pt',
        theme: localStorage.getItem('vrisingTheme') || 'light'
      },
      
      // Inicializa√ß√£o
      init() {
        this.loadData();
        this.setupEventListeners();
        this.applySettings();
      },
      
      // Carregar dados
      async loadData() {
        try {
          const [itemsResponse, workbenchesResponse] = await Promise.all([
            fetch('items.json'),
            fetch('workbenches.json')
          ]);
          
          if (!itemsResponse.ok || !workbenchesResponse.ok) {
            throw new Error('Erro ao carregar dados');
          }
          
          const [itemsData, workbenchesData] = await Promise.all([
            itemsResponse.json(),
            workbenchesResponse.json()
          ]);
          
          this.data.items = itemsData.items || [];
          this.data.workbenches = workbenchesData.workbenches || [];
          
          // Mostrar p√°gina inicial
          this.showHome();
          
        } catch (error) {
          console.error('Erro ao carregar dados:', error);
          this.showError('Erro ao carregar os dados. Por favor, tente recarregar a p√°gina.');
        }
      },
      
      // Configurar event listeners
      setupEventListeners() {
        // Bot√µes do menu
        document.querySelectorAll('.menu-button').forEach(btn => {
          btn.addEventListener('click', () => {
            const content = btn.getAttribute('data-content');
            this.navigateTo(content);
          });
        });
        
        // Tema
        document.getElementById('toggleTheme').addEventListener('click', () => {
          this.toggleTheme();
        });
        
        // Idioma
        document.getElementById('languageSelect').addEventListener('change', (e) => {
          this.setLanguage(e.target.value);
        });
      },
      
      // Aplicar configura√ß√µes salvas
      applySettings() {
        // Tema
        document.documentElement.setAttribute('data-theme', this.data.theme);
        this.updateThemeButton();
        
        // Idioma
        document.getElementById('languageSelect').value = this.data.language;
      },
      
      // Navega√ß√£o
      navigateTo(page) {
        // Atualizar bot√µes ativos
        document.querySelectorAll('.menu-button').forEach(btn => {
          btn.setAttribute('aria-pressed', btn.getAttribute('data-content') === page);
        });
        
        // Mostrar p√°gina correspondente
        switch(page) {
          case 'home':
            this.showHome();
            break;
          case 'calculator':
            this.showCalculator();
            break;
          case 'favorites':
            this.showFavorites();
            break;
          case 'items':
            this.showItems();
            break;
          case 'workbenches':
            this.showWorkbenches();
            break;
          default:
            this.showHome();
        }
      },
      
      // Alternar tema
      toggleTheme() {
        this.data.theme = this.data.theme === 'light' ? 'dark' : 'light';
        document.documentElement.setAttribute('data-theme', this.data.theme);
        localStorage.setItem('vrisingTheme', this.data.theme);
        this.updateThemeButton();
      },
      
      // Atualizar bot√£o de tema
      updateThemeButton() {
        const themeBtn = document.getElementById('toggleTheme');
        const icon = themeBtn.querySelector('i');
        const text = themeBtn.querySelector('span');
        
        if (this.data.theme === 'dark') {
          icon.className = 'fas fa-sun';
          text.textContent = 'Tema Claro';
        } else {
          icon.className = 'fas fa-moon';
          text.textContent = 'Tema Escuro';
        }
      },
      
      // Definir idioma
      setLanguage(lang) {
        this.data.language = lang;
        localStorage.setItem('vrisingLanguage', lang);
        // Aqui voc√™ implementaria a l√≥gica de tradu√ß√£o
        console.log('Idioma alterado para:', lang);
      },
      
      // Mostrar erro
      showError(message) {
        const main = document.getElementById('main');
        main.innerHTML = `
          <div class="error-message">
            <i class="fas fa-exclamation-triangle"></i>
            <div>${message}</div>
          </div>
          <button onclick="window.location.reload()">
            <i class="fas fa-sync-alt"></i> Recarregar
          </button>
        `;
      },
      
      // P√°ginas da aplica√ß√£o
      showHome() {
        const main = document.getElementById('main');
        main.innerHTML = `
          <h1>Bem-vindo √† Calculadora V Rising</h1>
          <p>Esta ferramenta ajuda voc√™ a calcular os materiais necess√°rios para criar itens no jogo V Rising.</p>
          
          <div class="result-container">
            <h2>Recursos dispon√≠veis:</h2>
            <ul class="materials-list">
              <li><i class="fas fa-calculator"></i> Calculadora de materiais</li>
              <li><i class="fas fa-star"></i> Lista de itens favoritos</li>
              <li><i class="fas fa-box-open"></i> Cat√°logo completo de itens</li>
              <li><i class="fas fa-hammer"></i> Informa√ß√µes sobre bancadas</li>
            </ul>
          </div>
          
          <h2>Dicas de uso</h2>
          <div class="result-container">
            <ul class="materials-list">
              <li>Use a calculadora para planejar suas constru√ß√µes</li>
              <li>Adicione itens frequentes aos favoritos</li>
              <li>Altere o tema no menu √† esquerda</li>
            </ul>
          </div>
        `;
      },
      
      showCalculator() {
        const main = document.getElementById('main');
        main.innerHTML = `
          <h1><i class="fas fa-calculator"></i> Calculadora de Crafting</h1>
          
          <div class="search-container">
            <label for="itemSearch">Buscar item:</label>
            <input type="text" id="itemSearch" placeholder="Digite o nome do item..." autocomplete="off" />
            <ul id="suggestions" class="suggestions"></ul>
          </div>
          
          <label for="quantityInput">Quantidade:</label>
          <input type="number" id="quantityInput" min="1" value="1" />
          
          <button id="calculateBtn" class="calculate-btn">
            <i class="fas fa-calculator"></i> Calcular materiais
          </button>
          
          <div id="result" class="result-container" style="display:none;"></div>
        `;
        
        this.setupCalculator();
      },
      
      setupCalculator() {
        const itemSearch = document.getElementById('itemSearch');
        const suggestions = document.getElementById('suggestions');
        const quantityInput = document.getElementById('quantityInput');
        const calculateBtn = document.getElementById('calculateBtn');
        const result = document.getElementById('result');
        
        let selectedItem = null;
        
        // Busca de itens
        itemSearch.addEventListener('input', () => {
          const term = itemSearch.value.trim().toLowerCase();
          suggestions.innerHTML = '';
          
          if (term.length < 2) {
            suggestions.style.display = 'none';
            return;
          }
          
          const filtered = this.data.items.filter(item => 
            item.name.toLowerCase().includes(term) ||
            (item.type && item.type.toLowerCase().includes(term))
            ).slice(0, 10);
          
          if (filtered.length > 0) {
            filtered.forEach(item => {
              const li = document.createElement('li');
              li.innerHTML = `
                <img src="${item.image || 'https://via.placeholder.com/24'}" alt="${item.name}" />
                <span>${item.name}</span>
                <span class="item-type">${item.type}</span>
              `;
              li.addEventListener('click', () => {
                selectedItem = item;
                itemSearch.value = item.name;
                suggestions.style.display = 'none';
              });
              suggestions.appendChild(li);
            });
            suggestions.style.display = 'block';
          } else {
            suggestions.style.display = 'none';
          }
        });
        
        // Fechar sugest√µes ao clicar fora
        document.addEventListener('click', (e) => {
          if (!suggestions.contains(e.target) && e.target !== itemSearch) {
            suggestions.style.display = 'none';
          }
        });
        
        // Calcular materiais
        calculateBtn.addEventListener('click', () => {
          const quantity = parseInt(quantityInput.value) || 1;
          
          if (!selectedItem) {
            alert('Por favor, selecione um item da lista.');
            return;
          }
          
          this.showItemDetails(selectedItem, quantity);
        });
      },
      
      showItemDetails(item, quantity = 1) {
        const result = document.getElementById('result');
        result.style.display = 'block';
        
        // Verificar se √© favorito
        const isFavorite = this.data.favorites.some(fav => fav.id === item.id);
        
        result.innerHTML = `
          <div class="result-header">
            <img src="${item.image || 'https://via.placeholder.com/100?text=No+Image'}" 
                 alt="${item.name}" 
                 class="item-image"
                 data-tooltip="${item.name}" />
            
            <div class="item-info">
              <h2>
                ${item.name} (x${quantity})
                <button class="favorite-btn ${isFavorite ? 'active' : ''}" 
                        data-id="${item.id}"
                        data-tooltip="${isFavorite ? 'Remover dos favoritos' : 'Adicionar aos favoritos'}">
                  <i class="fas fa-star"></i>
                </button>
              </h2>
              
              <div class="item-meta">
                ${item.type ? `<span><i class="fas fa-tag"></i> ${item.type}</span>` : ''}
                ${item.origin ? `<span><i class="fas fa-map-marker-alt"></i> ${item.origin}</span>` : ''}
              </div>
              
              ${item.description ? `<p class="item-description">${item.description}</p>` : ''}
            </div>
          </div>
          
          <h3><i class="fas fa-box-open"></i> Materiais necess√°rios:</h3>
          ${this.renderMaterials(item.crafting?.materials || [], quantity)}
        `;
        
        // Adicionar evento ao bot√£o de favorito
        result.querySelector('.favorite-btn').addEventListener('click', (e) => {
          this.toggleFavorite(item);
          e.target.classList.toggle('active');
          e.target.setAttribute('data-tooltip', 
            e.target.classList.contains('active') ? 'Remover dos favoritos' : 'Adicionar aos favoritos');
        });
        
        // Adicionar eventos aos bot√µes de expans√£o
        this.setupExpandButtons();
        
        // Rolagem suave para o resultado
        result.scrollIntoView({ behavior: 'smooth' });
      },
      
      renderMaterials(materials, quantity, depth = 0) {
        if (!materials || materials.length === 0) {
          return '<p>Este item n√£o requer materiais para crafting.</p>';
        }

        let html = '<ul class="materials-list">';

        materials.forEach(mat => {
          // Verifica√ß√£o robusta do item
          const matItem = this.data.items.find(i => i.id === mat.item);
          if (!matItem) {
            console.error(`Item n√£o encontrado: ${mat.item}`);
            return; // Pula este material se o item n√£o existir
          }

          // C√°lculo seguro da quantidade
          const matQuantity = Number(mat.quantity) || 0;
          const totalQty = Math.ceil(matQuantity * quantity);
          
          if (isNaN(totalQty) || totalQty <= 0) {
            console.error(`Quantidade inv√°lida para ${matItem.name}`);
            return;
          }

          const hasSub = matItem?.crafting?.materials?.length > 0;
          const nestedId = `nested-${matItem.id}-${depth}`;

          html += `
            <li>
              <img src="${matItem.image || 'placeholder.png'}" alt="${matItem.name}" />
              <span>${totalQty}x ${matItem.name}</span>
              ${hasSub ? `
                <button class="expand-btn" 
                        data-item="${matItem.id}" 
                        data-qty="${totalQty}" 
                        data-depth="${depth + 1}">
                  <i class="fas fa-chevron-down"></i> Detalhes
                </button>
              ` : ''}
              <div id="${nestedId}" class="nested-materials" style="display:none;"></div>
            </li>
          `;
        });

        html += '</ul>';
        return html;
      },
      
      setupExpandButtons() {
        document.querySelectorAll('.expand-btn').forEach(btn => {
          btn.addEventListener('click', () => {
            const itemId = btn.getAttribute('data-item');
            const qty = parseInt(btn.getAttribute('data-qty')) || 1; // Default para 1 se inv√°lido
            const depth = parseInt(btn.getAttribute('data-depth')) || 1;
            const targetDiv = document.getElementById(`nested-${itemId}-${depth - 1}`);
            const icon = btn.querySelector('i');
            
            const item = this.data.items.find(i => i.id === itemId);
            if (!targetDiv || !item?.crafting?.materials?.length) return;
            
            if (targetDiv.style.display === 'none') {
              targetDiv.style.display = 'block';
              targetDiv.innerHTML = this.renderMaterials(
                item.crafting.materials, 
                qty / (item.crafting.quantity || 1), // Evita divis√£o por zero
                depth
              );
              icon.className = 'fas fa-chevron-up';
              btn.innerHTML = `${icon.outerHTML} Ocultar`;
              this.setupExpandButtons(); // Reconfigura os novos bot√µes
            } else {
              targetDiv.style.display = 'none';
              icon.className = 'fas fa-chevron-down';
              btn.innerHTML = `${icon.outerHTML} Detalhes`;
            }
          });
        });
      },
      
      toggleFavorite(item) {
        const index = this.data.favorites.findIndex(fav => fav.id === item.id);
        
        if (index === -1) {
          this.data.favorites.push({
            id: item.id,
            name: item.name,
            image: item.image,
            type: item.type
          });
        } else {
          this.data.favorites.splice(index, 1);
        }
        
        localStorage.setItem('vrisingFavorites', JSON.stringify(this.data.favorites));
      },
      
      showFavorites() {
        const main = document.getElementById('main');
        
        if (this.data.favorites.length === 0) {
          main.innerHTML = `
            <h1><i class="fas fa-star"></i> Favoritos</h1>
            <div class="result-container">
              <p>Voc√™ ainda n√£o adicionou itens aos favoritos.</p>
              <p>Use a calculadora e clique no √≠cone de estrela para adicionar itens aqui.</p>
            </div>
          `;
          return;
        }
        
        let html = `
          <h1><i class="fas fa-star"></i> Favoritos</h1>
          <div class="result-container">
            <ul class="materials-list">
        `;
        
        this.data.favorites.forEach(item => {
          html += `
            <li onclick="VrisingCalculator.showFavoriteItem('${item.id}')" style="cursor:pointer;">
              <img src="${item.image || 'https://via.placeholder.com/24'}" alt="${item.name}" />
              <span>${item.name}</span>
              <span class="item-type">${item.type}</span>
            </li>
          `;
        });
        
        html += `
            </ul>
          </div>
        `;
        
        main.innerHTML = html;
      },
      
      showFavoriteItem(itemId) {
        const item = this.data.items.find(i => i.id === itemId);
        if (!item) return;
        
        this.showCalculator();
        setTimeout(() => {
          document.getElementById('itemSearch').value = item.name;
          this.showItemDetails(item, 1);
        }, 100);
      },
      
      showItems() {
        const main = document.getElementById('main');
        let html = `
          <h1><i class="fas fa-box-open"></i> Todos os Itens</h1>
          <div class="search-container">
            <label for="itemsSearch">Filtrar itens:</label>
            <input type="text" id="itemsSearch" placeholder="Digite para filtrar..." />
          </div>
          
          <div class="result-container">
            <div id="itemsList" class="items-grid">
        `;
        
        // Agrupar itens por tipo
        const itemsByType = {};
        this.data.items.forEach(item => {
          if (!itemsByType[item.type]) {
            itemsByType[item.type] = [];
          }
          itemsByType[item.type].push(item);
        });
        
        // Adicionar itens ao HTML
        for (const [type, items] of Object.entries(itemsByType)) {
          html += `
            <h3>${type}</h3>
            <ul class="materials-list">
          `;
          
          items.forEach(item => {
            html += `
              <li onclick="VrisingCalculator.showItemDetailsFromList('${item.id}')" style="cursor:pointer;">
                <img src="${item.image || 'https://via.placeholder.com/24'}" alt="${item.name}" />
                <span>${item.name}</span>
                <span class="item-type">${item.origin}</span>
              </li>
            `;
          });
          
          html += `</ul>`;
        }
        
        html += `
            </div>
          </div>
        `;
        
        main.innerHTML = html;
        
        // Configurar busca na lista de itens
        document.getElementById('itemsSearch').addEventListener('input', (e) => {
          const term = e.target.value.toLowerCase();
          document.querySelectorAll('#itemsList li').forEach(li => {
            const text = li.textContent.toLowerCase();
            li.style.display = text.includes(term) ? 'flex' : 'none';
          });
        });
      },
      
      showItemDetailsFromList(itemId) {
        const item = this.data.items.find(i => i.id === itemId);
        if (!item) return;
        
        this.showCalculator();
        setTimeout(() => {
          document.getElementById('itemSearch').value = item.name;
          this.showItemDetails(item, 1);
        }, 100);
      },
      
      showWorkbenches() {
        const main = document.getElementById('main');
        let html = `
          <h1><i class="fas fa-hammer"></i> Bancadas de Trabalho</h1>
          <div class="result-container">
            <ul class="materials-list">
        `;
        
        this.data.workbenches.forEach(wb => {
          html += `
            <li>
              <img src="${wb.image || 'https://via.placeholder.com/24'}" alt="${wb.name}" />
              <div>
                <strong>${wb.name}</strong><br>
                <small>${wb.description}</small>
              </div>
            </li>
          `;
        });
        
        html += `
            </ul>
          </div>
        `;
        
        main.innerHTML = html;
      }
    };
    
    // Inicializar a aplica√ß√£o quando o DOM estiver pronto
    document.addEventListener('DOMContentLoaded', () => {
      VrisingCalculator.init();
      
      // Adicionar √≠cones do Lucide (que usa Feather icons)
      lucide.createIcons();
    });
    
    // Expor fun√ß√µes para o escopo global (para eventos onclick em HTML)
    window.VrisingCalculator = VrisingCalculator;
  </script>
</body>
</html>